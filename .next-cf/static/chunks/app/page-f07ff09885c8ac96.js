(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9270:function(e,t,s){Promise.resolve().then(s.bind(s,7019)),Promise.resolve().then(s.bind(s,1963)),Promise.resolve().then(s.bind(s,165)),Promise.resolve().then(s.bind(s,9676)),Promise.resolve().then(s.bind(s,505)),Promise.resolve().then(s.bind(s,9870)),Promise.resolve().then(s.bind(s,1431)),Promise.resolve().then(s.bind(s,4770)),Promise.resolve().then(s.bind(s,4428)),Promise.resolve().then(s.bind(s,157)),Promise.resolve().then(s.bind(s,8285)),Promise.resolve().then(s.t.bind(s,8326,23)),Promise.resolve().then(s.bind(s,27)),Promise.resolve().then(s.bind(s,1960)),Promise.resolve().then(s.bind(s,5674))},27:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var a=s(7437);s(2265);var r=s(1396),n=s.n(r),l=s(6691),o=s.n(l),c=s(5828),i=s(2005),h=s(2913);function d(e){let{comic:t,className:s=""}=e;console.log("Comic data:",t),console.log("ChaptersLatest:",t.chaptersLatest),console.log("Chapters:",t.chapters),console.log("Total chapters:",t.total_chapters);let r="?";if(t.chaptersLatest&&t.chaptersLatest.length>0){let e=t.chaptersLatest[0].chapter_name.match(/\d+/);e&&(r=e[0])}if("?"===r&&t.total_chapters&&t.total_chapters>0&&(r=t.total_chapters.toString()),"?"===r&&t.chapters&&t.chapters.length>0){for(let e of t.chapters)if(e.server_data&&e.server_data.length>0){for(let t of e.server_data){let e=t.chapter_name.match(/\d+/);if(e){r=e[0];break}}if("?"!==r)break}}let l="";if(t.chaptersLatest&&t.chaptersLatest.length>0)try{l=(0,i.Z)(new Date(t.updatedAt),{addSuffix:!0,locale:h.vi})}catch(e){l="gần đ\xe2y"}return(0,a.jsxs)(n(),{href:"/truyen/".concat(t.slug),className:"group ".concat(s),children:[(0,a.jsxs)("div",{className:"relative aspect-[2/3] rounded-lg overflow-hidden",children:[(0,a.jsx)(o(),{src:(0,c.J)(t.thumb_url),alt:t.name,fill:!0,className:"object-cover transition-transform duration-300 group-hover:scale-105",sizes:"(max-width: 768px) 50vw, (max-width: 1200px) 33vw, 25vw",loading:"lazy",onError:e=>{let t=e.target;t.src="/images/placeholder.jpg"}}),(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),(0,a.jsxs)("div",{className:"absolute top-1 md:top-2 left-1 md:left-2 px-1.5 py-0.5 md:px-2 md:py-1 text-[10px] md:text-xs rounded-full bg-pink-600 text-white",children:["Chap ",r]})]}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("h3",{className:"font-medium text-white line-clamp-2 group-hover:text-pink-400 transition-colors",children:t.name}),l&&(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[(0,a.jsx)("span",{className:"font-medium text-pink-400",children:"Cập Nhật:"}),(0,a.jsx)("span",{children:l})]})})]})]})}},1960:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var a=s(7437),r=s(6691),n=s.n(r),l=s(1396),o=s.n(l),c=s(2265),i=s(5828);function h(e){let{comics:t}=e,s=(0,c.useRef)(null),[r,l]=(0,c.useState)(0),[h,d]=(0,c.useState)(!1),m=(0,c.useCallback)(()=>{if(s.current){let e=(r+1)%t.length;l(e),s.current.scrollTo({left:e*s.current.offsetWidth,behavior:"smooth"})}},[r,t.length]);(0,c.useEffect)(()=>{if(h){let e=setInterval(()=>{m()},3e3);return()=>clearInterval(e)}},[h,m]),(0,c.useEffect)(()=>{if(s.current){let e=r*(h?180:200);s.current.scrollTo({left:e,behavior:"smooth"})}},[r,h]),(0,c.useEffect)(()=>{let e=()=>{d(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let u=()=>{let e=Math.max(0,r-Math.floor(2.5)),s=Math.min(t.length-1,e+5-1);return s-e<4&&e>0&&(e=Math.max(0,s-5+1)),t.slice(e,s+1)};return(0,a.jsxs)("div",{className:"carousel-container relative w-full",children:[(0,a.jsx)("div",{ref:s,className:"carousel-slider flex items-center justify-center overflow-x-auto snap-x snap-mandatory scrollbar-hide relative",children:(0,a.jsx)("div",{className:"flex items-center justify-center mx-auto",children:u().map((e,s)=>{let r=u(),c=Math.floor(r.length/2),h=s===c,d=Math.abs(s-c),m=h?1.2:Math.max(.85,1-.07*d);return(0,a.jsx)("div",{className:"carousel-slide transition-all duration-700 ease-in-out ".concat(h?"z-10":"z-0"),style:{transform:"scale(".concat(m,")"),opacity:h?1:Math.max(.8,1-.06*d),transformOrigin:"center bottom",marginLeft:h?"20px":"10px",marginRight:h?"20px":"10px",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>l(t.indexOf(e)),children:(0,a.jsx)(o(),{href:"/truyen/".concat(e.slug),className:"block group relative",children:(0,a.jsxs)("div",{className:"relative aspect-[2/3] overflow-hidden rounded-lg shadow-lg w-[180px] h-[270px]",children:[(0,a.jsx)(n(),{src:(0,i.J)(e.thumb_url),alt:e.name,width:180,height:270,className:"object-cover w-full h-full transition-transform duration-500 group-hover:scale-110 ".concat(h?"brightness-110":""),onError:e=>{let t=e.target;t.src="/images/placeholder.jpg"}}),h&&(0,a.jsxs)("div",{className:"absolute inset-0",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-tr from-transparent via-white/10 to-white/30 mix-blend-overlay"}),(0,a.jsx)("div",{className:"shine-effect"})]}),(0,a.jsxs)("div",{className:"absolute top-2 right-2 flex flex-col gap-1",children:[(0,a.jsx)("span",{className:"label-hot text-white px-2 py-1 rounded-full text-xs font-bold",children:"HOT"}),(0,a.jsx)("span",{className:"label-new text-white px-2 py-1 rounded-full text-xs font-bold",children:"MỚI"}),e.sub_docquyen&&(0,a.jsx)("span",{className:"label-exclusive text-white px-2 py-1 rounded-full text-xs font-bold",children:"ĐỘC"})]}),(0,a.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-3 bg-gradient-to-t from-black/90 via-black/70 to-transparent",children:[(0,a.jsx)("h3",{className:"text-sm font-bold text-white line-clamp-1",children:e.name}),e.chaptersLatest&&e.chaptersLatest.length>0&&(0,a.jsx)("p",{className:"text-gray-200 text-xs",children:e.chaptersLatest[0].chapter_name})]})]})})},e._id)})})}),(0,a.jsx)("button",{onClick:()=>{r>0?l(r-1):l(t.length-1)},className:"absolute left-0 top-1/2 -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white p-2 rounded-r-full z-10 focus:outline-none text-sm",children:"◀"}),(0,a.jsx)("button",{onClick:m,className:"absolute right-0 top-1/2 -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white p-2 rounded-l-full z-10 focus:outline-none text-sm",children:"▶"})]})}},5674:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var a=s(7437),r=s(2265),n=s(1396),l=s.n(n);function o(){let[e,t]=(0,r.useState)([]);return((0,r.useEffect)(()=>{let e=async()=>{try{let e=await fetch("/api/history"),{data:s}=await e.json();t(s)}catch(e){console.error("Error fetching reading history:",e)}};e()},[]),0===e.length)?null:(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Lịch sử đọc"}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:e.map(e=>{let t=Math.floor((Date.now()-e.timestamp)/1e3),s="";return s=t<60?"".concat(t," gi\xe2y trước"):t<3600?"".concat(Math.floor(t/60)," ph\xfat trước"):t<86400?"".concat(Math.floor(t/3600)," giờ trước"):"".concat(Math.floor(t/86400)," ng\xe0y trước"),(0,a.jsxs)(l(),{href:"/truyen/".concat(e.comic.slug,"/chapter/").concat(e.chapter.slug),className:"block p-4 bg-gray-800 rounded-lg hover:bg-gray-700 transition-colors",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2 line-clamp-1",children:e.comic.name}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:e.chapter.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:s})]},"".concat(e.comic._id,"-").concat(e.chapter.slug))})})]})}},5828:function(e,t,s){"use strict";function a(e){return e?e.startsWith("http")?e:e.startsWith("/data/images/")?"https://img.otruyenapi.com".concat(e):"https://img.otruyenapi.com/uploads/comics/".concat(e):"/images/placeholder.jpg"}s.d(t,{J:function(){return a}})}},function(e){e.O(0,[326,699,413,404,971,472,744],function(){return e(e.s=9270)}),_N_E=e.O()}]);